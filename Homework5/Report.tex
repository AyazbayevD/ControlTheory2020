%%% Template originaly created by Karol Kozio≈Ç (mail@karol-koziol.net) and modified for ShareLaTeX use

\documentclass[a4paper,11pt]{article}

\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{hyperref}

\renewcommand\familydefault{\sfdefault}
\usepackage{tgheros}
\usepackage[defaultmono]{droidmono}

\usepackage{amsmath,amssymb,amsthm,textcomp}
\usepackage{enumerate}
\usepackage{multicol}
\usepackage{tikz}

\usepackage{geometry}
\geometry{left=25mm,right=25mm,%
bindingoffset=0mm, top=20mm,bottom=20mm}


\linespread{1.3}

\newcommand{\linia}{\rule{\linewidth}{0.5pt}}

% custom theorems if needed
\newtheoremstyle{mytheor}
    {1ex}{1ex}{\normalfont}{0pt}{\scshape}{.}{1ex}
    {{\thmname{#1 }}{\thmnumber{#2}}{\thmnote{ (#3)}}}

\theoremstyle{mytheor}
\newtheorem{defi}{Definition}

% my own titles
\makeatletter
\renewcommand{\maketitle}{
\begin{center}
\vspace{2ex}
{\huge \textsc{\@title}}
\vspace{1ex}
\\
\linia\\
\@author \hfill \@date
\vspace{4ex}
\end{center}
}
\makeatother
%%%

% custom footers and headers
\usepackage{fancyhdr}
\pagestyle{fancy}
\lhead{}
\chead{}
\rhead{}
\cfoot{}
\rfoot{Page \thepage}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}
%

% code listing settings
\usepackage{listings}
\lstset{
    language=Python,
    basicstyle=\ttfamily\small,
    aboveskip={1.0\baselineskip},
    belowskip={1.0\baselineskip},
    columns=fixed,
    extendedchars=true,
    breaklines=true,
    tabsize=4,
    prebreak=\raisebox{0ex}[0ex][0ex]{\ensuremath{\hookleftarrow}},
    frame=lines,
    showtabs=false,
    showspaces=false,
    showstringspaces=false,
    keywordstyle=\color[rgb]{0.627,0.126,0.941},
    commentstyle=\color[rgb]{0.133,0.545,0.133},
    stringstyle=\color[rgb]{01,0,0},
    numbers=left,
    numberstyle=\small,
    stepnumber=1,
    numbersep=10pt,
    captionpos=t,
    escapeinside={\%*}{*)}
}

%%%----------%%%----------%%%----------%%%----------%%%

\begin{document}

\title{Control Theory Assignment \textnumero{} 5}

\author{Danat Ayazbayev, BS-18-03}

\maketitle

\section*{1. Variant selection}
\textbf{Name:} Danat\newline
\textbf{Email: } d.ayazbaev@innopolis.university\newline
\textbf{Variant: } e\newline
$M=4.2,m=5.5,l=2.1,g=9.81$

\section*{A. Prove that it is possible to design state observer of the linearized system.}
First of all, we should linearize our system. Let's refer to the Homework 4, where I referred to the material $Linearization.pdf$. But since now there are another values of constants, I changed them.
\[
M=4.2,m=5.5,l=2.1,g=9.81
\]
\[
A=
\begin{bmatrix}
0&0&1&0\\
0&0&0&1\\
0&\frac{mg}{M}&0&0\\
0&\frac{(m+M)g}{Ml}&0&0\\
\end{bmatrix}
,B=
\begin{bmatrix}
0\\
0\\
\frac{1}{M}\\
\frac{1}{Ml}\\
\end{bmatrix}
\]
\[
A=
\begin{bmatrix}
0&0&1&0\\
0&0&0&1\\
0&\frac{3597}{280}&0&0\\
0&\frac{10573}{980}&0&0\\
\end{bmatrix}
,B=
\begin{bmatrix}
0\\
0\\
\frac{5}{21}\\
\frac{50}{441}\\
\end{bmatrix}
,C=
\begin{bmatrix}
1&0&0&0\\
0&1&0&0\\
\end{bmatrix}
\]
\textbf{Notes}\newline
Friction coefficient is zero in the task, so $A_{3,3}, A_{4,3}$ both are $0$.\newline
Also equations are constructed differently in the material, and for this task correct thing will be positive signs at $A_{3,2}$ and $B_{4,1}$\newline
\textbf{Solution}\newline
Let $Q=[C^{T}$\space\space$A^{T}C^{T}]$\newline
\[
C^{T}=
\begin{bmatrix}
1&0\\
0&1\\
0&0\\
0&0\\
\end{bmatrix}
,A^{T}C^{T}=
\begin{bmatrix}
0&0&0&0\\
0&0&\frac{3597}{280}&\frac{10573}{980}\\
1&0&0&0\\
0&1&0&0\\
\end{bmatrix}
\begin{bmatrix}
1&0\\
0&1\\
0&0\\
0&0\\
\end{bmatrix}
=
\begin{bmatrix}
0&0\\
0&0\\
1&0\\
0&1\\
\end{bmatrix}
\]
\[
Q=I=
\begin{bmatrix}
1&0&0&0\\
0&1&0&0\\
0&0&1&0\\
0&0&0&1\\
\end{bmatrix}
\]
Determinant of Q is $1 \neq 0$, so our system is observable and we can design state observer for the system.
\section*{B. For open loop state observer, is the error dynamics stable?}
To check open loop dynamics, we should make $B=0$, to get rid of the feedback. Then, we should find eigenvalues of $A-Bu$, but because $B=0$, we should only find eigenvalues of $A$.
\[
\lambda I-A=
\begin{bmatrix}
\lambda&0&-1&0\\
0&\lambda&0&-1\\
0&-\frac{3597}{280}&\lambda&0\\
0&-\frac{10573}{980}&0&\lambda\\
\end{bmatrix}
\]
\[
det(\lambda I-A)=0  
\]
From this equation, we find eigenvalues:
\[
\lambda_{1}=0,
\lambda_{2}=\frac{\sqrt{52865}}{70}
\lambda_{3}=\frac{-\sqrt{52865}}{70}
\]
Because not all eigenvalues are negative, open-loop dynamics is unstable.
\section*{C. Design Luenberger observer for linearized system using both pole placement and LQR methods.}
Let's find such matrix $L$, for which such statement holds: Real part of eigenvalues of $(A-LC)$ matrix should be negative.
\[
A-LC=
\begin{bmatrix}
0&0&1&0\\
0&0&0&1\\
0&\frac{3597}{280}&0&0\\
0&\frac{10573}{980}&0&0\\
\end{bmatrix}
-
\begin{bmatrix}
L_{11}&L_{12}\\
L_{21}&L_{22}\\
L_{31}&L_{32}\\
L_{41}&L_{42}\\
\end{bmatrix}
\begin{bmatrix}
1&0&0&0\\
0&1&0&0\\
\end{bmatrix}
=
\begin{bmatrix}
-L_{11}&-L_{12}&1&0\\
-L_{21}&-L_{22}&0&1\\
-L_{31}&\frac{3597}{280}-L_{32}&0&0\\
-L_{41}&\frac{10573}{980}-L_{42}&0&0\\
\end{bmatrix}
\]
\[
\lambda I-(A-LC)=
\begin{bmatrix}
\lambda+L_{11}&-L_{12}&-1&0\\
L_{21}&\lambda+L_{22}&0&-1\\
L_{31}&L_{32}-\frac{3597}{280}&\lambda&0\\
L_{41}&L_{42}-\frac{10573}{980}&0&\lambda\\
\end{bmatrix}
\]
\[
det(\lambda I-(A-LC))=0
\]
I skipped the part with calculation of $L$ matrix, because it is too long. At least now we know how to design Luenberger observer. After calculating $L$ matrix, our Luenberger observer can be described as:
\[
\dot{\hat{x}}=A\hat{x}+L(y-C\hat{x})
\]
where $A\hat{x}$ is predictor and $L(y-C\hat{x})$ is a corrector.


\end{document}
